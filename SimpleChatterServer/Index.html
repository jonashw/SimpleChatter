<!DOCTYPE html>

<html>
	<head>
		<title>SimpleChatter</title>
		<script src="/Scripts/jquery-1.6.4.js"></script>
		<script src="/Scripts/jquery.signalR-2.2.0.js"></script>
		<script src="/Scripts/ChatMessagesComponent.js"></script>
		<script src="/Scripts/CurrentlyTypingComponent.js"></script>
		<script src="signalr/hubs"></script>
		<link rel="stylesheet" href="/Stylesheets/bootstrap.min.css"/>
		<script>
			$(function () {
				var userName = prompt('Please enter a user name:', 'Test User');
				var chat = $.connection.chatHub;
				var $log = $('#chatLog');
				var $form = $('#messageForm');
				var $input = $('#messageInput').focus();
				let components = [
					new CurrentlyTypingComponent(userName, $form, chat),
					new ChatMessagesComponent(userName, $log, $form, $input, chat)
				];
				$.connection.hub.start().done(function () {
					console.log('now connected.  ID=' + $.connection.hub.id);
					components.forEach(c => c.start());
				});
			});
		</script>
		<style>
			#chatLog {
				height:300px;
				overflow-y: scroll;
			}
			.mt-1 {
				margin-top: 8px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="page-header" style="border-bottom:none;">
				<h1>Welcome to SimpleChatter!</h1>
				<p class="lead">
					A simple chat server/client
				</p>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">
					<div class="panel-title">
						Chatter Log
					</div>
				</div>
				<div class="panel-body" id="chatLog"></div>
				<div class="panel-footer">
					<form id="messageForm" autocomplete="off">
						<div class="input-group">
							<input class="form-control" type="text" id="messageInput">
							<span class="input-group-btn">
								<button type="submit" class="btn btn-primary media-object" id="sendBtn">
									Send
								</button>
							</span> 
						</div>
						<div id="typingStatus"></div>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>